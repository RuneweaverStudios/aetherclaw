{
  "project": "Aether-Claw",
  "branchName": "ralph/aether-claw-core",
  "description": "A secure, swarm-based AI assistant system with persistent memory, proactive automation, and cryptographically signed skills",
  "userStories": [
    {"id": "US-001", "title": "Create brain_index.py SQLite memory indexer", "description": "As a developer, I need a Python utility to index Markdown brain files into SQLite for RAG retrieval.", "acceptanceCriteria": ["Create brain_index.py in project root", "Connect to brain/brain_index.db SQLite database", "Create brain_index table with id, file_name, content, timestamp, version columns", "Create full-text search index on content column", "Implement index_file() function to parse and store MD files", "Implement search_memory(query, limit) function for RAG queries", "Index all existing .md files in brain/ directory", "Handle file not found and database errors gracefully", "Typecheck passes with mypy or pyright"], "priority": 1, "passes": true, "notes": "Implemented with BrainIndexer class, FTS5 support, version history"},
    {"id": "US-002", "title": "Create RSA key generation utility", "description": "As a developer, I need a utility to generate RSA key pairs for skill signing.", "acceptanceCriteria": ["Create keygen.py in project root", "Generate RSA-2048 private key using cryptography library", "Save private key to ~/.claude/secure/secure_key.pem", "Extract and save public key to ~/.claude/secure/public_key.pem", "Create ~/.claude/secure/ directory if it doesn't exist", "Set restrictive file permissions (600) on private key", "Add command-line interface for key generation", "Typecheck passes"], "priority": 2, "passes": true, "notes": "KeyManager class with sign_data and verify_signature methods"},
    {"id": "US-003", "title": "Create safe_skill_creator.py with signing", "description": "As a developer, I need a skill creation utility that signs skills cryptographically.", "acceptanceCriteria": ["Create safe_skill_creator.py in project root", "Implement load_private_key() to load RSA key from PEM file", "Implement load_public_key() for verification", "Implement scan_code() to run bandit security scanner on skill code", "Implement sign_skill(code, skill_name) to create cryptographic signature", "Implement verify_skill(skill_name) to validate signature before loading", "Save signed skills to skills/{skill_name}.json with code and signature", "Reject skills that fail bandit scan", "Typecheck passes"], "priority": 3, "passes": true, "notes": "SafeSkillCreator with Bandit integration and PSS signatures"},
    {"id": "US-004", "title": "Create skill loader with verification", "description": "As a developer, I need a skill loader that verifies signatures before loading skills.", "acceptanceCriteria": ["Create skill_loader.py in project root", "Implement load_skill(skill_name) that verifies signature before loading", "Raise SecurityError if signature verification fails", "Raise SecurityError if skill is unsigned", "Log all skill load attempts to audit_log.md", "Implement list_skills() to show all available skills with signature status", "Implement unload_skill(skill_name) for safe removal", "Typecheck passes"], "priority": 4, "passes": true, "notes": "SkillLoader with dynamic module loading and verification"},
    {"id": "US-005", "title": "Create audit logger utility", "description": "As a developer, I need a dedicated audit logging utility for all swarm actions.", "acceptanceCriteria": ["Create audit_logger.py in project root", "Implement log_action(level, agent, action, details) function", "Support levels: INFO, WARN, ERROR, SECURITY, AUDIT", "Format entries with ISO 8601 timestamps", "Append to brain/audit_log.md in specified format", "Implement log_skill_execution(skill_name, agent, outcome)", "Implement log_security_event(event_type, details)", "Implement log_anomaly(anomaly_type, severity, resolution)", "Typecheck passes"], "priority": 5, "passes": true, "notes": "AuditLogger class with structured logging"},
    {"id": "US-006", "title": "Create swarm configuration loader", "description": "As a developer, I need a configuration loader for swarm_config.json.", "acceptanceCriteria": ["Create config_loader.py in project root", "Implement load_config() to parse swarm_config.json", "Implement get_model_routing() to return tier configurations", "Implement get_safety_gate_config() for permission settings", "Implement requires_confirmation(action_type) to check if action needs approval", "Implement get_kill_switch_triggers() for halt conditions", "Handle missing config file with sensible defaults", "Validate config schema on load", "Typecheck passes"], "priority": 6, "passes": true, "notes": "ConfigLoader with dataclasses and defaults"},
    {"id": "US-007", "title": "Create safety gate module", "description": "As a developer, I need a safety gate that requires user confirmation for sensitive actions.", "acceptanceCriteria": ["Create safety_gate.py in project root", "Implement check_permission(action_type, details) -> bool", "Implement request_confirmation(action_type, details) -> bool for CLI prompts", "Define ACTION_CATEGORIES enum with all action types", "Log all permission checks to audit log", "Implement block_action(action_type, reason) for explicit blocks", "Support environment variable to bypass for testing (AETHER_UNSAFE_MODE)", "Typecheck passes"], "priority": 7, "passes": true, "notes": "SafetyGate with PermissionResult and ActionCategory enum"},
    {"id": "US-008", "title": "Create kill switch module", "description": "As a developer, I need a kill switch to halt all swarm operations on security events.", "acceptanceCriteria": ["Create kill_switch.py in project root", "Implement arm_kill_switch() to activate monitoring", "Implement trigger_kill_switch(reason) to halt operations", "Implement is_armed() -> bool to check status", "Monitor for: unsigned skill execution, signature failures, unauthorized access", "Log all kill switch events to audit log", "Create .kill_switch_flag file when triggered", "Implement reset_kill_switch() for manual recovery", "Typecheck passes"], "priority": 8, "passes": true, "notes": "KillSwitch with background monitoring and flag file"},
    {"id": "US-009", "title": "Create heartbeat daemon base", "description": "As a developer, I need a daemon that runs scheduled proactive tasks.", "acceptanceCriteria": ["Create heartbeat_daemon.py in project root", "Load heartbeat configuration from brain/heartbeat.md", "Implement run_heartbeat() main loop with configurable interval", "Parse YAML task definitions from heartbeat.md", "Implement execute_task(task_name) for individual tasks", "Log all heartbeat executions to audit log", "Support graceful shutdown on SIGINT/SIGTERM", "Typecheck passes"], "priority": 9, "passes": true, "notes": "HeartbeatDaemon with task registry and background thread"},
    {"id": "US-010", "title": "Create Git repository scanner task", "description": "As a user, I want the heartbeat to scan my Git repos for issues.", "acceptanceCriteria": ["Create tasks/git_scanner.py", "Implement scan_repository(repo_path) to check for issues", "Detect uncommitted changes", "Detect unpushed branches", "Detect stale branches older than 30 days", "Detect potential merge conflicts", "Return structured report of findings", "Run in read-only mode (no modifications)", "Typecheck passes"], "priority": 10, "passes": true, "notes": "RepositoryStatus with issues and stale branch detection"},
    {"id": "US-011", "title": "Create memory index update task", "description": "As a user, I want the heartbeat to keep the memory index updated.", "acceptanceCriteria": ["Create tasks/memory_updater.py", "Implement check_memory_changes() to detect file modifications", "Call brain_index.py functions to reindex changed files", "Track last index timestamp to avoid unnecessary updates", "Log index updates to audit log", "Handle concurrent access safely", "Typecheck passes"], "priority": 11, "passes": true, "notes": "FileChange tracking with hash comparison"},
    {"id": "US-012", "title": "Create skill integrity checker task", "description": "As a user, I want the heartbeat to verify skill signatures periodically.", "acceptanceCriteria": ["Create tasks/skill_checker.py", "Implement check_all_skills() to verify all loaded skills", "Use skill_loader.verify_skill() for each skill", "Report unsigned or tampered skills", "Trigger kill switch on integrity failure", "Log all integrity checks to audit log", "Typecheck passes"], "priority": 12, "passes": true, "notes": "IntegrityCheckResult with skill verification"},
    {"id": "US-013", "title": "Create system health monitor task", "description": "As a user, I want the heartbeat to monitor system health.", "acceptanceCriteria": ["Create tasks/health_monitor.py", "Implement check_cpu_usage() returning percentage", "Implement check_memory_usage() returning percentage", "Implement check_disk_space(path) returning available MB", "Detect anomalies (CPU > 80% for > 60s)", "Trigger kill switch on resource anomalies", "Log health metrics to audit log", "Typecheck passes"], "priority": 13, "passes": true, "notes": "SystemHealth with psutil integration and anomaly detection"},
    {"id": "US-014", "title": "Create notification utility", "description": "As a developer, I need a notification utility using plyer for system notifications.", "acceptanceCriteria": ["Create notifier.py in project root", "Implement send_notification(title, message, level) using plyer", "Support levels: info, warning, error", "Log all notifications to audit log", "Handle notification failures gracefully", "Implement send_confirmation_request(title, message) for interactive prompts", "Typecheck passes"], "priority": 14, "passes": true, "notes": "Notifier with plyer and fallback logging"},
    {"id": "US-015", "title": "Create GLM API client wrapper", "description": "As a developer, I need a client to interact with the GLM-4 API for swarm agents.", "acceptanceCriteria": ["Create glm_client.py in project root", "Load API key from environment or config", "Implement call_glm(prompt, model, max_tokens) -> str", "Support tier_1 (GLM-4.7) and tier_2 (GLM-4.7-Flash) model selection", "Implement proper error handling for API failures", "Add retry logic with exponential backoff", "Log API calls to audit log (without sensitive data)", "Typecheck passes"], "priority": 15, "passes": true, "notes": "GLMClient with retry logic and statistics"},
    {"id": "US-016", "title": "Create swarm worker base class", "description": "As a developer, I need a base class for swarm worker agents.", "acceptanceCriteria": ["Create swarm/worker.py", "Create Worker base class with id, role, and status properties", "Implement assign_task(task) method", "Implement execute_task() abstract method", "Implement report_progress() to update status", "Add thinking process logging before output", "Support graceful shutdown", "Typecheck passes"], "priority": 16, "passes": true, "notes": "Worker ABC with thinking process logging"},
    {"id": "US-017", "title": "Create architect agent", "description": "As a developer, I need an architect agent that decomposes problems and does security reviews.", "acceptanceCriteria": ["Create swarm/architect.py extending Worker", "Implement decompose_problem(task) returning subtasks", "Implement security_assessment(task) returning risk report", "Use GLM tier_1 for reasoning tasks", "Log all architectural decisions to audit log", "Validate decomposed tasks against soul.md goals", "Typecheck passes"], "priority": 17, "passes": true, "notes": "Architect with decomposition and security assessment"},
    {"id": "US-018", "title": "Create action worker agent", "description": "As a developer, I need worker agents for executing tasks.", "acceptanceCriteria": ["Create swarm/action_worker.py extending Worker", "Implement execute_code_task(task) for coding tasks", "Implement execute_test_task(task) for testing", "Use GLM tier_2 for action tasks", "Run tasks in isolated environment", "Log all actions to audit log", "Typecheck passes"], "priority": 18, "passes": true, "notes": "ActionWorker with code, test, and documentation tasks"},
    {"id": "US-019", "title": "Create swarm orchestrator", "description": "As a developer, I need an orchestrator to manage the swarm of workers.", "acceptanceCriteria": ["Create swarm/orchestrator.py", "Implement spawn_architect() to create architect agent", "Implement spawn_workers(count) to create action workers", "Implement distribute_tasks(tasks) to assign tasks to workers", "Implement collect_results() to gather worker outputs", "Implement monitor_progress() for status tracking", "Support max 3 concurrent workers", "Typecheck passes"], "priority": 19, "passes": true, "notes": "SwarmOrchestrator with ThreadPoolExecutor"},
    {"id": "US-020", "title": "Create Docker isolation wrapper", "description": "As a developer, I need Docker isolation for worker execution.", "acceptanceCriteria": ["Create isolation/docker_wrapper.py", "Implement create_container(worker_id, config) using docker-py", "Implement run_in_container(container, command) -> result", "Set resource limits (CPU, memory)", "Disable network by default", "Drop all capabilities", "Implement cleanup_container(container) for removal", "Typecheck passes"], "priority": 20, "passes": false, "notes": ""},
    {"id": "US-021", "title": "Create Git worktree manager", "description": "As a developer, I need a Git worktree manager for worker isolation.", "acceptanceCriteria": ["Create isolation/worktree.py", "Implement create_worktree(branch_name, base_branch) -> path", "Implement remove_worktree(path) for cleanup", "Implement list_worktrees() returning all active worktrees", "Generate unique branch names with worker ID", "Handle conflicts gracefully", "Typecheck passes"], "priority": 21, "passes": false, "notes": ""},
    {"id": "US-022", "title": "Create Streamlit dashboard base", "description": "As a user, I want a web dashboard to monitor the swarm.", "acceptanceCriteria": ["Create dashboard.py using Streamlit", "Set page title and layout", "Create sidebar with navigation", "Add refresh interval configuration", "Load configuration from swarm_config.json", "Typecheck passes"], "priority": 22, "passes": true, "notes": "Dashboard with multi-page navigation"},
    {"id": "US-023", "title": "Add live log viewer to dashboard", "description": "As a user, I want to see live logs in the dashboard.", "acceptanceCriteria": ["Add log viewer section to dashboard.py", "Read and display brain/audit_log.md", "Auto-refresh logs every 5 seconds", "Add log level filter (INFO, WARN, ERROR, SECURITY)", "Show timestamps and agent names", "Typecheck passes"], "priority": 23, "passes": true, "notes": "render_live_logs with filtering"},
    {"id": "US-024", "title": "Add brain editor to dashboard", "description": "As a user, I want to edit brain files in the dashboard.", "acceptanceCriteria": ["Add brain editor section to dashboard.py", "List all .md files in brain/ directory", "Provide text editor for selected file", "Add save button with confirmation", "Show version history (from brain_index.db)", "Typecheck passes"], "priority": 24, "passes": true, "notes": "render_brain_editor with save and history"},
    {"id": "US-025", "title": "Add heartbeat status to dashboard", "description": "As a user, I want to see heartbeat status in the dashboard.", "acceptanceCriteria": ["Add heartbeat status section to dashboard.py", "Show next scheduled heartbeat time", "Display last 5 heartbeat results", "Show enabled/disabled tasks from heartbeat.md", "Add manual trigger button for heartbeat", "Typecheck passes"], "priority": 25, "passes": true, "notes": "render_heartbeat with manual trigger"},
    {"id": "US-026", "title": "Add skill verification display to dashboard", "description": "As a user, I want to see skill signatures in the dashboard.", "acceptanceCriteria": ["Add skill verification section to dashboard.py", "List all skills in skills/ directory", "Show signature status (valid/invalid/unsigned)", "Display signature timestamp", "Alert on unsigned skills with visual indicator", "Typecheck passes"], "priority": 26, "passes": true, "notes": "render_skills with signature status"},
    {"id": "US-027", "title": "Create requirements.txt", "description": "As a developer, I need a requirements file for all dependencies.", "acceptanceCriteria": ["Create requirements.txt in project root", "Include: cryptography, bandit, plyer, streamlit, docker, pyyaml", "Include: sqlite3 (stdlib, no need to list)", "Add version pins for stability", "Typecheck passes"], "priority": 27, "passes": true, "notes": "All dependencies with version pins"},
    {"id": "US-028", "title": "Create pyproject.toml for project config", "description": "As a developer, I need modern Python project configuration.", "acceptanceCriteria": ["Create pyproject.toml in project root", "Configure project metadata (name, version, description)", "Configure mypy settings with strict mode", "Configure pytest settings", "Define entry points for CLI commands", "Typecheck passes"], "priority": 28, "passes": true, "notes": "Full pyproject.toml with mypy, pytest, black config"},
    {"id": "US-029", "title": "Create example signed skill", "description": "As a developer, I need an example skill to demonstrate the signing workflow.", "acceptanceCriteria": ["Create skills/example_skill.py with simple utility function", "Document skill in skills/README.md", "Show how to sign using safe_skill_creator.py", "Show how to verify using skill_loader.py", "Typecheck passes"], "priority": 29, "passes": true, "notes": "example_skill.py with greet, calculate, format_timestamp"},
    {"id": "US-030", "title": "Create main CLI entry point", "description": "As a user, I want a unified CLI to interact with Aether-Claw.", "acceptanceCriteria": ["Create aether_claw.py as main entry point", "Implement 'index' command to run brain_index.py", "Implement 'sign-skill' command for skill signing", "Implement 'verify-skills' command to check all skills", "Implement 'heartbeat' command to run daemon", "Implement 'dashboard' command to launch Streamlit", "Implement 'status' command to show system status", "Typecheck passes"], "priority": 30, "passes": true, "notes": "Full CLI with all commands implemented"},
    {"id": "US-031", "title": "Create README.md documentation", "description": "As a user, I want comprehensive documentation for Aether-Claw.", "acceptanceCriteria": ["Create README.md in project root", "Include project overview and features", "Include installation instructions", "Include quick start guide", "Document CLI commands", "Document security model", "Include architecture diagram (ASCII)", "Typecheck passes"], "priority": 31, "passes": true, "notes": "Full README with architecture diagram"}
  ]
}
